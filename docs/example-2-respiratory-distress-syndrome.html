<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Example 2: Respiratory Distress Syndrome | main.knit</title>
  <meta name="description" content="S2Y Lab 8<br />
Comparing regression lines</div>" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Example 2: Respiratory Distress Syndrome | main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Example 2: Respiratory Distress Syndrome | main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example-1-cholesterol-levels-in-iowa-and-nebraska.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="include/webex.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to S2Y Lab 8</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#intro"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-1-cholesterol-levels-in-iowa-and-nebraska.html"><a href="example-1-cholesterol-levels-in-iowa-and-nebraska.html"><i class="fa fa-check"></i><b>2</b> Example 1: Cholesterol levels in Iowa and Nebraska</a>
<ul>
<li class="chapter" data-level="2.1" data-path="example-1-cholesterol-levels-in-iowa-and-nebraska.html"><a href="example-1-cholesterol-levels-in-iowa-and-nebraska.html#exploratory-analysis"><i class="fa fa-check"></i><b>2.1</b> Exploratory analysis</a></li>
<li class="chapter" data-level="2.2" data-path="example-1-cholesterol-levels-in-iowa-and-nebraska.html"><a href="example-1-cholesterol-levels-in-iowa-and-nebraska.html#statistical-analysis"><i class="fa fa-check"></i><b>2.2</b> Statistical analysis</a></li>
<li class="chapter" data-level="2.3" data-path="example-1-cholesterol-levels-in-iowa-and-nebraska.html"><a href="example-1-cholesterol-levels-in-iowa-and-nebraska.html#confidence-intervals"><i class="fa fa-check"></i><b>2.3</b> Confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-2-respiratory-distress-syndrome.html"><a href="example-2-respiratory-distress-syndrome.html"><i class="fa fa-check"></i><b>3</b> Example 2: Respiratory Distress Syndrome</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">S2Y Lab 8<br />
Comparing regression lines</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-2-respiratory-distress-syndrome" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Example 2: Respiratory Distress Syndrome<a href="example-2-respiratory-distress-syndrome.html#example-2-respiratory-distress-syndrome" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We have seen this example in Lecture 15. To recap, premature babies often suffer from a variety of problems and respiratory distress syndrome (RDS) is a major one of these problems. It is thought that the occurrence of this syndrome might be related to a property of the blood called red cell deformability. This refers to the ability of red cells to change shape to pass through small pores. The rate (Lrate, on a log scale) of blood flow through a set of 3<span class="math inline">\(\mu\)</span>m pores has been recorded for two groups of babies, some of whom suffer from respiratory distress syndrome (RDS = 2) and some who do not (RDS = 1). The gestational age (GA) in weeks of each baby is also recorded. These data were kindly provided by Queen Mother's Hospital, Glasgow.</p>
<p>Read in the data using:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="example-2-respiratory-distress-syndrome.html#cb22-1" aria-hidden="true" tabindex="-1"></a>rds <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;respiratory.csv&quot;</span>)</span></code></pre></div>
<p>The dataset contains three columns:</p>
<div class="line-block">   C1: Lrate<br />
   C2: GA<br />
   C3: RDS (1 = does not suffer from RDS, 2 = suffers from RDS)</div>
<p><br>
Use what you have learned from <strong>Example 1</strong> to answer the following question of interest.</p>
<p><strong>Question of interest</strong>: Are there any differences between the rate of blood flow measurements for babies that do, and do not, suffer from RDS, after correcting for the gestational age?</p>
<p><strong>TASK</strong>:</p>
<ol style="list-style-type: decimal">
<li>Produce a scatterplot to explore the relationship between <code>Lrate</code> and <code>GA</code>, labelled by RDS. Do you think this relationship differs by <code>RDS</code>? Which model do you think is most appropriate to describe the data?</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="example-2-respiratory-distress-syndrome.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Lrate <span class="sc">~</span> GA, <span class="at">pch =</span> RDS, <span class="at">data =</span> rds, <span class="at">ylab =</span> <span class="st">&quot;LRate (log rate of blood flow)&quot;</span>,</span>
<span id="cb23-2"><a href="example-2-respiratory-distress-syndrome.html#cb23-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Gestational age (Weeks)&quot;</span>)</span>
<span id="cb23-3"><a href="example-2-respiratory-distress-syndrome.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;No RDS&quot;</span>, <span class="st">&quot;RDS&quot;</span>), <span class="at">pch =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="main_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Build regression models corresponding to different regression lines, parallel regression lines and a single regression line. Based on the ANOVA table, comment on which model is most appropriate.</li>
</ol>
<div class="webex-solution">
<button>
Hint
</button>
<p>Recall that the <code>lm</code> command for different regression lines has the form of <code>lm(Y ~ X1 * X2)</code> and that for parallel regression lines has the form of <code>lm(Y ~ X1 + X2)</code>.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="example-2-respiratory-distress-syndrome.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different lines model</span></span>
<span id="cb24-2"><a href="example-2-respiratory-distress-syndrome.html#cb24-2" aria-hidden="true" tabindex="-1"></a>Model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Lrate <span class="sc">~</span> GA <span class="sc">*</span> RDS, <span class="at">data =</span> rds)</span>
<span id="cb24-3"><a href="example-2-respiratory-distress-syndrome.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Model1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Lrate
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## GA         1 5.9335  5.9335 13.5081 0.001608 **
## RDS        1 0.0466  0.0466  0.1062 0.748129   
## GA:RDS     1 0.0806  0.0806  0.1836 0.673147   
## Residuals 19 8.3458  0.4393                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="example-2-respiratory-distress-syndrome.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parallel lines model</span></span>
<span id="cb26-2"><a href="example-2-respiratory-distress-syndrome.html#cb26-2" aria-hidden="true" tabindex="-1"></a>Model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Lrate <span class="sc">~</span> GA <span class="sc">+</span> RDS, <span class="at">data =</span> rds)</span>
<span id="cb26-3"><a href="example-2-respiratory-distress-syndrome.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Model2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Lrate
##           Df Sum Sq Mean Sq F value   Pr(&gt;F)   
## GA         1 5.9335  5.9335 14.0830 0.001253 **
## RDS        1 0.0466  0.0466  0.1107 0.742844   
## Residuals 20 8.4264  0.4213                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="example-2-respiratory-distress-syndrome.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># single regression line model</span></span>
<span id="cb28-2"><a href="example-2-respiratory-distress-syndrome.html#cb28-2" aria-hidden="true" tabindex="-1"></a>Model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Lrate <span class="sc">~</span> GA, <span class="at">data =</span> rds)</span>
<span id="cb28-3"><a href="example-2-respiratory-distress-syndrome.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Model3)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Lrate
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## GA         1 5.9335  5.9335  14.706 0.0009637 ***
## Residuals 21 8.4730  0.4035                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In Model 1, we see that the <span class="math inline">\(p\)</span>-value for <code>GA:RDS</code> is larger than 0.05, meaning that the interaction term is not statistically significant. Therefore, it is inappropriate to fit different regression lines to this dataset.</p>
<p>In Model 2, we see that the <span class="math inline">\(p\)</span>-value for <code>RDS</code> is larger than 0.05, meaning that including the factor <code>RDS</code> is not useful in predicting <code>Lrate</code>.</p>
<p>In Model 3, we see that the <span class="math inline">\(p\)</span>-value for <code>GA</code> is smaller than 0.05, meaning that including <code>GA</code> is useful in predicting <code>Lrate</code>. Therefore, the most appropriate model, among different regression lines, parallel regression lines and a single regression line, for this dataset is the single regression line model.</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Construct confidence intervals to compare the models.</li>
</ol>
<p>The 95% confidence interval for <span class="math inline">\((\beta_1-\beta_2)\)</span> is (<input class='webex-solveme nospaces' size='10' data-answer='["-0.1751249","-0.175125","-0.17512","-0.1751","-0.175","-0.18"]'/>, <input class='webex-solveme nospaces' size='9' data-answer='["0.2652747","0.265275","0.26528","0.2653","0.265","0.27"]'/>).</p>
<p>The 95% confidence interval for <span class="math inline">\(\alpha_1 - \alpha_2 + \beta \left(\bar{x}_{2.} - \bar{x}_{1.}\right)\)</span> is (<input class='webex-solveme nospaces' size='10' data-answer='["-0.5802435","-0.580244","-0.58024","-0.5802","-0.58","-.5802435","-.580244","-.58024","-.5802","-.58"]'/>, <input class='webex-solveme nospaces' size='9' data-answer='["0.8004354","0.800435","0.80044","0.8004","0.8",".8004354",".800435",".80044",".8004",".8"]'/>).</p>
<p>Among different regression lines, parallel regression lines and a single regression line, the most appropriate model for this dataset is <select class='webex-select'><option value='blank'></option><option value=''>different regression lines</option><option value=''>parallel regression lines</option><option value='answer'>a single regression line</option></select>,</p>
<div class="webex-solution">
<button>
Hint
</button>
<p>The confidence interval should be constructed for <span class="math inline">\((\beta_1-\beta_2)\)</span> in order to compare between different regression lines and parallel regression lines.</p>
<p>The confidence interval should be constructed for <span class="math inline">\(\alpha_1 - \alpha_2 + \beta \left(\bar{x}_{2.} - \bar{x}_{1.}\right)\)</span> in order to compare between parallel regression lines and a single regression line.</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="example-2-respiratory-distress-syndrome.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># different lines model</span></span>
<span id="cb30-2"><a href="example-2-respiratory-distress-syndrome.html#cb30-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> rds<span class="sc">$</span>GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">1</span>]</span>
<span id="cb30-3"><a href="example-2-respiratory-distress-syndrome.html#cb30-3" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> rds<span class="sc">$</span>GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">2</span>]</span>
<span id="cb30-4"><a href="example-2-respiratory-distress-syndrome.html#cb30-4" aria-hidden="true" tabindex="-1"></a>xbar1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x1)</span>
<span id="cb30-5"><a href="example-2-respiratory-distress-syndrome.html#cb30-5" aria-hidden="true" tabindex="-1"></a>xbar2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(x2)</span>
<span id="cb30-6"><a href="example-2-respiratory-distress-syndrome.html#cb30-6" aria-hidden="true" tabindex="-1"></a>GA <span class="ot">&lt;-</span> rds<span class="sc">$</span>GA</span>
<span id="cb30-7"><a href="example-2-respiratory-distress-syndrome.html#cb30-7" aria-hidden="true" tabindex="-1"></a>GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">1</span>] <span class="ot">&lt;-</span> GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">1</span>] <span class="sc">-</span> xbar1</span>
<span id="cb30-8"><a href="example-2-respiratory-distress-syndrome.html#cb30-8" aria-hidden="true" tabindex="-1"></a>GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">2</span>] <span class="ot">&lt;-</span> GA[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">2</span>] <span class="sc">-</span> xbar2</span>
<span id="cb30-9"><a href="example-2-respiratory-distress-syndrome.html#cb30-9" aria-hidden="true" tabindex="-1"></a>Model1_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(rds<span class="sc">$</span>Lrate <span class="sc">~</span> GA <span class="sc">*</span> <span class="fu">as.factor</span>(rds<span class="sc">$</span>RDS))</span>
<span id="cb30-10"><a href="example-2-respiratory-distress-syndrome.html#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Remark 1: GA is the centred covariate, rather than the original rds$GA</span></span>
<span id="cb30-11"><a href="example-2-respiratory-distress-syndrome.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Remark 2: RDS is a factor and we need to tell this information to R by using as.factor(); otherwise R will treat it as a continuous variable.</span></span>
<span id="cb30-12"><a href="example-2-respiratory-distress-syndrome.html#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Model1_b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rds$Lrate ~ GA * as.factor(rds$RDS))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.87508 -0.43260  0.00379  0.20733  1.43714 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)             0.39583    0.19132   2.069   0.0524 .
## GA                      0.17222    0.08242   2.090   0.0503 .
## as.factor(rds$RDS)2    -0.65765    0.27665  -2.377   0.0281 *
## GA:as.factor(rds$RDS)2 -0.04507    0.10521  -0.428   0.6731  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6628 on 19 degrees of freedom
## Multiple R-squared:  0.4207, Adjusted R-squared:  0.3292 
## F-statistic: 4.599 on 3 and 19 DF,  p-value: 0.01392</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="example-2-respiratory-distress-syndrome.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Model1_b)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: rds$Lrate
##                       Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## GA                     1 3.4979  3.4979  7.9633 0.01089 *
## as.factor(rds$RDS)     1 2.4822  2.4822  5.6510 0.02811 *
## GA:as.factor(rds$RDS)  1 0.0806  0.0806  0.1836 0.67315  
## Residuals             19 8.3458  0.4393                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="example-2-respiratory-distress-syndrome.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate least squares estimates</span></span>
<span id="cb34-2"><a href="example-2-respiratory-distress-syndrome.html#cb34-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> rds<span class="sc">$</span>Lrate[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">1</span>]</span>
<span id="cb34-3"><a href="example-2-respiratory-distress-syndrome.html#cb34-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> rds<span class="sc">$</span>Lrate[rds<span class="sc">$</span>RDS<span class="sc">==</span><span class="dv">2</span>]</span>
<span id="cb34-4"><a href="example-2-respiratory-distress-syndrome.html#cb34-4" aria-hidden="true" tabindex="-1"></a>ybar1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y1)</span>
<span id="cb34-5"><a href="example-2-respiratory-distress-syndrome.html#cb34-5" aria-hidden="true" tabindex="-1"></a>ybar2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(y2)</span>
<span id="cb34-6"><a href="example-2-respiratory-distress-syndrome.html#cb34-6" aria-hidden="true" tabindex="-1"></a>Sx1x1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x1 <span class="sc">-</span> xbar1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-7"><a href="example-2-respiratory-distress-syndrome.html#cb34-7" aria-hidden="true" tabindex="-1"></a>Sx2x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x2 <span class="sc">-</span> xbar2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb34-8"><a href="example-2-respiratory-distress-syndrome.html#cb34-8" aria-hidden="true" tabindex="-1"></a>Sx1y1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x1 <span class="sc">-</span> xbar1) <span class="sc">*</span> (y1 <span class="sc">-</span> ybar1))</span>
<span id="cb34-9"><a href="example-2-respiratory-distress-syndrome.html#cb34-9" aria-hidden="true" tabindex="-1"></a>Sx2y2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((x2 <span class="sc">-</span> xbar2) <span class="sc">*</span> (y2 <span class="sc">-</span> ybar2))</span>
<span id="cb34-10"><a href="example-2-respiratory-distress-syndrome.html#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ybar1,Sx1y1<span class="sc">/</span>Sx1x1,ybar2,Sx2y2<span class="sc">/</span>Sx2x2)) </span></code></pre></div>
<pre><code>## [1]  0.3958333  0.1722165 -0.2618182  0.1271416</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="example-2-respiratory-distress-syndrome.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate confidence intervals</span></span>
<span id="cb36-2"><a href="example-2-respiratory-distress-syndrome.html#cb36-2" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">anova</span>(Model1_b)[<span class="dv">4</span>,<span class="dv">2</span>]</span>
<span id="cb36-3"><a href="example-2-respiratory-distress-syndrome.html#cb36-3" aria-hidden="true" tabindex="-1"></a>n1  <span class="ot">&lt;-</span> <span class="fu">length</span>(x1)</span>
<span id="cb36-4"><a href="example-2-respiratory-distress-syndrome.html#cb36-4" aria-hidden="true" tabindex="-1"></a>n2  <span class="ot">&lt;-</span> <span class="fu">length</span>(x2)</span>
<span id="cb36-5"><a href="example-2-respiratory-distress-syndrome.html#cb36-5" aria-hidden="true" tabindex="-1"></a>t.val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>,<span class="at">df=</span>n1<span class="sc">+</span>n2<span class="dv">-4</span>)</span>
<span id="cb36-6"><a href="example-2-respiratory-distress-syndrome.html#cb36-6" aria-hidden="true" tabindex="-1"></a>ese <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(RSS<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-4</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>Sx1x1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>Sx2x2))</span>
<span id="cb36-7"><a href="example-2-respiratory-distress-syndrome.html#cb36-7" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">coef</span>(Model1_b)[<span class="dv">4</span>] <span class="sc">-</span> t.val<span class="sc">*</span>ese </span>
<span id="cb36-8"><a href="example-2-respiratory-distress-syndrome.html#cb36-8" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">coef</span>(Model1_b)[<span class="dv">4</span>] <span class="sc">+</span> t.val<span class="sc">*</span>ese </span>
<span id="cb36-9"><a href="example-2-respiratory-distress-syndrome.html#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="example-2-respiratory-distress-syndrome.html#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(lower,upper))</span></code></pre></div>
<pre><code>## GA:as.factor(rds$RDS)2 GA:as.factor(rds$RDS)2 
##             -0.1751249              0.2652747</code></pre>
<p>The confidence interval for <span class="math inline">\((\beta_1-\beta_2)\)</span> includes zero, meaning that it is likely that the interaction term does not have any effect in predicting the response variable. Therefore, we would prefer parallel regression lines over different regression lines.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="example-2-respiratory-distress-syndrome.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parallel lines model</span></span>
<span id="cb38-2"><a href="example-2-respiratory-distress-syndrome.html#cb38-2" aria-hidden="true" tabindex="-1"></a>Model2_b <span class="ot">&lt;-</span> <span class="fu">lm</span>(rds<span class="sc">$</span>Lrate <span class="sc">~</span> GA <span class="sc">+</span> <span class="fu">as.factor</span>(rds<span class="sc">$</span>RDS))</span>
<span id="cb38-3"><a href="example-2-respiratory-distress-syndrome.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Model2_b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = rds$Lrate ~ GA + as.factor(rds$RDS))
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.89309 -0.40617 -0.03309  0.26879  1.48324 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)          0.39583    0.18738   2.113  0.04742 * 
## GA                   0.14455    0.05017   2.881  0.00923 **
## as.factor(rds$RDS)2 -0.65765    0.27095  -2.427  0.02478 * 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6491 on 20 degrees of freedom
## Multiple R-squared:  0.4151, Adjusted R-squared:  0.3566 
## F-statistic: 7.097 on 2 and 20 DF,  p-value: 0.004686</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="example-2-respiratory-distress-syndrome.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(Model2_b)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: rds$Lrate
##                    Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## GA                  1 3.4979  3.4979  8.3022 0.00923 **
## as.factor(rds$RDS)  1 2.4822  2.4822  5.8915 0.02478 * 
## Residuals          20 8.4264  0.4213                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="example-2-respiratory-distress-syndrome.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate least squares estimates</span></span>
<span id="cb42-2"><a href="example-2-respiratory-distress-syndrome.html#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(ybar1,ybar2,(Sx1y1<span class="sc">+</span>Sx2y2)<span class="sc">/</span>(Sx1x1<span class="sc">+</span>Sx2x2))) <span class="co">#least squares estimates based on formulae</span></span></code></pre></div>
<pre><code>## [1]  0.3958333 -0.2618182  0.1445547</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="example-2-respiratory-distress-syndrome.html#cb44-1" aria-hidden="true" tabindex="-1"></a>Coef <span class="ot">&lt;-</span><span class="fu">coef</span>(Model2_b)</span>
<span id="cb44-2"><a href="example-2-respiratory-distress-syndrome.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(Coef[<span class="dv">1</span>],Coef[<span class="dv">1</span>]<span class="sc">+</span>Coef[<span class="dv">3</span>],Coef[<span class="dv">2</span>])) <span class="co">#read least squares estimates from R</span></span></code></pre></div>
<pre><code>## (Intercept) (Intercept)          GA 
##   0.3958333  -0.2618182   0.1445547</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="example-2-respiratory-distress-syndrome.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate confidence intervals</span></span>
<span id="cb46-2"><a href="example-2-respiratory-distress-syndrome.html#cb46-2" aria-hidden="true" tabindex="-1"></a>Sy1y1 <span class="ot">&lt;-</span> <span class="fu">sum</span>((y1 <span class="sc">-</span> ybar1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-3"><a href="example-2-respiratory-distress-syndrome.html#cb46-3" aria-hidden="true" tabindex="-1"></a>Sy2y2 <span class="ot">&lt;-</span> <span class="fu">sum</span>((y2 <span class="sc">-</span> ybar2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-4"><a href="example-2-respiratory-distress-syndrome.html#cb46-4" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">anova</span>(Model2_b)[<span class="dv">3</span>,<span class="dv">2</span>]</span>
<span id="cb46-5"><a href="example-2-respiratory-distress-syndrome.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sy1y1 + Sy2y2 - (Sx1y1+Sx2y2)^2/(Sx1x1+Sx2x2) #RSS based on formula</span></span>
<span id="cb46-6"><a href="example-2-respiratory-distress-syndrome.html#cb46-6" aria-hidden="true" tabindex="-1"></a>t.val <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> n1<span class="sc">+</span>n2<span class="dv">-3</span>)</span>
<span id="cb46-7"><a href="example-2-respiratory-distress-syndrome.html#cb46-7" aria-hidden="true" tabindex="-1"></a>ese <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(RSS<span class="sc">/</span>(n1<span class="sc">+</span>n2<span class="dv">-3</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>n1<span class="sc">+</span><span class="dv">1</span><span class="sc">/</span>n2<span class="sc">+</span>(xbar2<span class="sc">-</span>xbar1)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(Sx1x1<span class="sc">+</span>Sx2x2)))</span>
<span id="cb46-8"><a href="example-2-respiratory-distress-syndrome.html#cb46-8" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">coef</span>(Model2_b)[<span class="dv">3</span>] <span class="sc">+</span> <span class="fu">coef</span>(Model2_b)[<span class="dv">2</span>]<span class="sc">*</span>(xbar2<span class="sc">-</span>xbar1) <span class="sc">-</span> t.val<span class="sc">*</span>ese</span>
<span id="cb46-9"><a href="example-2-respiratory-distress-syndrome.html#cb46-9" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">coef</span>(Model2_b)[<span class="dv">3</span>] <span class="sc">+</span> <span class="fu">coef</span>(Model2_b)[<span class="dv">2</span>]<span class="sc">*</span>(xbar2<span class="sc">-</span>xbar1) <span class="sc">+</span> t.val<span class="sc">*</span>ese</span>
<span id="cb46-10"><a href="example-2-respiratory-distress-syndrome.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(lower,upper))</span></code></pre></div>
<pre><code>## as.factor(rds$RDS)2 as.factor(rds$RDS)2 
##          -0.5802435           0.8004354</code></pre>
<p>The confidence interval for <span class="math inline">\(\alpha_1 - \alpha_2 + \beta \left(\bar{x}_{2.} - \bar{x}_{1.}\right)\)</span> includes zero, meaning that it is likely that <code>RDS</code> does not have any effect in predicting <code>Lrate</code>. Therefore, we would prefer a single regression line over parallel regression lines.</p>
</div>

</div>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>
            </section>

          </div>
        </div>
      </div>
<a href="example-1-cholesterol-levels-in-iowa-and-nebraska.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["main.pdf", "main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
